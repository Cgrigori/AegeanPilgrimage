from datetime import datetime
from . import db
from flask_login import UserMixin

class User(db.Model, UserMixin):
	id = db.Column(db.Integer, primary_key=True)
	email = db.Column(db.String(255), unique=True, index=True, nullable=False)
	password_hash = db.Column(db.String(255), nullable=False)
	name = db.Column(db.String(120))
	role = db.Column(db.String(20), default="user")  # admin, reviewer, creator, user
	avatar_url = db.Column(db.String(512))
	created_at = db.Column(db.DateTime, default=datetime.utcnow)

	def is_admin(self):
		return self.role == "admin"

	def is_reviewer(self):
		return self.role == "reviewer"

	def is_creator(self):
		return self.role == "creator"

class Trip(db.Model):
	id = db.Column(db.Integer, primary_key=True)
	title = db.Column(db.String(180), nullable=False)
	slug = db.Column(db.String(200), unique=True, index=True)
	description = db.Column(db.Text)
	price_cents = db.Column(db.Integer, default=0)
	currency = db.Column(db.String(3), default="USD")
	created_at = db.Column(db.DateTime, default=datetime.utcnow)
